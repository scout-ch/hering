import{d as T,j as t,F as $,n as R,o as N,r as o,p as z,L as F,i as j}from"./index-CCTNwLGU.js";import{M as S,r as b,L as y}from"./MarkdownComponents-D2OmoaxJ.js";function K(u){const{t:s}=T(),{keyword:e,onChange:a,onKeyDown:i}=u;return t.jsx("div",{className:"search-input",children:t.jsxs("div",{className:"icon-input",children:[t.jsx("div",{className:"icon",children:t.jsx($,{icon:R})}),t.jsx("input",{type:"text",name:"search",className:"search",placeholder:s("searchPage.searchPlaceholder"),value:e,onChange:a,onKeyDown:i,autoFocus:!0})]})})}class V{static matches(s,...e){if(s){const a=[],i=s.split(" ").filter(l=>l.length>0);return e.forEach(l=>{this.extractKeywordValues(l,a)}),i.every(l=>a.some(d=>this.contains(d,l)))}else return!0}static matchesExact(s,...e){if(s){const a=[];return e.forEach(i=>{this.extractKeywordValues(i,a)}),a.some(i=>this.contains(i,s))}else return!0}static extractKeywordValues(s,e){s instanceof Object?Object.keys(s).forEach(a=>{this.extractKeywordValues(s[a],e)}):s!=null&&e.push(s)}static contains(s,e){const a=(s||"").toString();return this.normalize(a).includes(this.normalize(e))}static normalize(s){return s.toLowerCase().replace(/[éèë]/g,"e").replace(/[àáäã]/g,"a").replace(/[òóöõ]/g,"o").replace(/[ü]/g,"u")}}function I(u){const{t:s}=T(),[e,a]=N(),i=o.useRef(!1),[l,d]=o.useState(""),[g,x]=o.useState([]),[_,f]=o.useState(!1),h=o.useRef(),k=o.useRef(u.sections.reduce((n,r)=>n.concat(r.chapters),[])),p=o.useCallback(n=>{f(!0),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(!n||n.length<3){x([]),f(!1);return}const r=k.current.filter(c=>V.matches(n,[c.title,c.content])).map(c=>({id:c.id,title:c.title,matchingContents:C(n,c.content),slug:c.slug_with_section}));x(r),f(!1),h.current=void 0},500)},[]);o.useEffect(()=>{if(!i.current){const n=e.get("keyword");n&&(d(n),p(n))}i.current=!0},[e,p]);const C=(n,r)=>{const c=new RegExp("!?\\[(.*?)]\\((.*?)\\)","gmi"),m=new RegExp(`[^.!?:;#
]*(?=${n}).*?[.!?](?=s?|p{Lu}|$)`,"gmi"),E=r.replace(c,"");return Array.from(E.matchAll(m)).reduce((L,P)=>L.concat(P),[])},Z=n=>{var m;n.preventDefault();const r=((m=n.currentTarget)==null?void 0:m.value)??"";d(r);const c=r.length>0?{keyword:r}:void 0;a(c,{replace:!0}),p(r)},v=()=>_?null:l.length>=3?g.length>0?g.map(n=>t.jsxs("div",{className:"search-result",children:[t.jsx("div",{className:"title-match",children:t.jsx(F,{to:"/"+n.slug,children:n.title})}),n.matchingContents.length>0?t.jsx("div",{className:"content-match",children:n.matchingContents.map((r,c)=>t.jsx(S,{remarkPlugins:[b],components:y,children:r},c))}):null]},n.id)):t.jsx("div",{children:s("searchPage.noResults")}):t.jsxs("div",{children:[" ",s("searchPage.noKeyword",{amountOfCharacters:3})]});return t.jsxs(t.Fragment,{children:[t.jsx(K,{keyword:l,onChange:Z}),t.jsx("br",{}),t.jsx(z,{isLoading:_}),t.jsx("div",{className:"search-results",children:v()})]})}const A=1,D="Suche",M="",O="Suche",q="de",G="2024-02-04T22:30:00.000Z",H="2024-02-04T22:30:00.000Z",Q="2024-02-04T22:30:00.000Z",B=[{id:2,locale:"fr",published_at:"2024-02-04T22:30:00.000Z"},{id:3,locale:"it",published_at:"2024-02-04T22:30:00.000Z"}],w={id:A,title:D,content:M,menu_name:O,locale:q,published_at:G,created_at:H,updated_at:Q,localizations:B},J=2,U="Recherche",W="",X="Recherche",Y="fr",ee="2024-02-04T22:30:00.000Z",te="2024-02-04T22:30:00.000Z",se="2024-02-04T22:30:00.000Z",ne=[{id:1,locale:"de",published_at:"2024-02-04T22:30:00.000Z"},{id:3,locale:"it",published_at:"2024-02-04T22:30:00.000Z"}],ae={id:J,title:U,content:W,menu_name:X,locale:Y,published_at:ee,created_at:te,updated_at:se,localizations:ne},ce=3,re="Cerca",oe="",ie="Cerca",le="it",ue="2024-02-04T22:30:00.000Z",de="2024-02-04T22:30:00.000Z",he="2024-02-04T22:30:00.000Z",me=[{id:1,locale:"de",published_at:"2024-02-04T22:30:00.000Z"},{id:2,locale:"fr",published_at:"2024-02-04T22:30:00.000Z"}],fe={id:ce,title:re,content:oe,menu_name:ie,locale:le,published_at:ue,created_at:de,updated_at:he,localizations:me};function _e(u){const s=j.language,[e,a]=o.useState();return o.useEffect(()=>{document.title=(e==null?void 0:e.title)??""},[e]),o.useEffect(()=>{switch(j.language){case"de":return a(w);case"fr":return a(ae);case"it":return a(fe);default:return a(w)}},[s]),o.useEffect(()=>{document.title=(e==null?void 0:e.title)??""},[e]),e?t.jsx("div",{className:"content-main",children:t.jsxs("div",{className:"search",children:[t.jsxs("h1",{children:[t.jsx($,{icon:R})," ",e.title]}),t.jsx(S,{remarkPlugins:[b],components:y,children:e.content}),t.jsx(I,{sections:u.sections})]})}):null}export{_e as default};
