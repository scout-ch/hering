"use strict";(self.webpackChunkhering=self.webpackChunkhering||[]).push([[176],{2982:(e,t,n)=>{n.d(t,{g:()=>d});var a=n(5043),s=n(5475),r=n(2624),l=n(3910),i=n(7929),c=n(579);function o(e){const{content:t}=e;return(0,c.jsxs)("div",{className:"warning",children:[(0,c.jsx)("div",{children:(0,c.jsx)(l.g,{icon:i.zpE})}),t]})}const d={blockquote(e){let{children:t}=e;return(0,c.jsx)(o,{content:t})},table(e){let{children:t}=e;return(0,c.jsx)("div",{className:"table-overflow",children:(0,c.jsx)("table",{children:t})})},a(e){let{node:t,children:n,...l}=e;const i=(0,a.useContext)(r.r),o=l.href,d=null===o||void 0===o?void 0:o.match("\\$(.*)\\$");if(d){const e=i.find((e=>e.key==d[1]));return e?e.link?(0,c.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:n}):e.slug?(0,c.jsx)(s.N_,{to:"/"+e.slug,children:n}):(0,c.jsx)(s.N_,{to:l.href||"",children:n}):(0,c.jsx)(s.N_,{to:l.href||"",children:n})}const h=null===o||void 0===o?void 0:o.match("(mailto:)");return h&&h.length>2&&h[1]?(0,c.jsx)(s.N_,{to:"#",onClick:e=>{window.location.href=l.href||"",e.preventDefault()},children:n}):(0,c.jsx)(s.N_,{to:l.href||"",children:n})},img(e){let{node:t,children:n,...a}=e;const s=a.alt,r=null===s||void 0===s?void 0:s.match("alt: (.*), (size: ((\\d*)x(\\d*)))?(width: (\\d*))?");return r?r[7]?(0,c.jsx)("img",{src:a.src,alt:r[1],width:r[7]}):(0,c.jsx)("img",{src:a.src,alt:r[1],width:r[4],height:r[5]}):(0,c.jsx)("img",{src:a.src,alt:a.alt})}}},9176:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var a=n(5043),s=n(3910),r=n(1404),l=n(5215),i=n(2982),c=n(4117),o=n(7653),d=n(5475),h=n(3370),g=n(579);const u=function(e){const{t:t}=(0,c.Bd)(),n=e.targets.map((e=>e.rolle)).join(", "),a=e.responsible.map((e=>t("target.role.".concat(e.rolle)))).join(", "),s=e.chapters.length>1?(0,g.jsx)("ul",{children:e.chapters.map((e=>(0,g.jsx)("li",{children:(0,g.jsx)(d.N_,{to:"/"+e.section.slug+"#"+e.slug,children:e.title})},e.slug)))}):e.chapters.map((e=>(0,g.jsx)(d.N_,{to:"/"+e.section.slug+"#"+e.slug,children:t("calendarPage.table.link")})));return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{align:"center",children:(0,h.GP)(e.deadline,"dd.MM.yyyy")}),(0,g.jsx)("th",{align:"left",children:e.title}),(0,g.jsx)("td",{children:a}),(0,g.jsx)("td",{children:n}),(0,g.jsx)("td",{align:"center",children:s})]})};const x=function(e){const t=e.tasks,{t:n}=(0,c.Bd)(),a=t.map((function(e){return(0,g.jsx)(u,{deadline:e.deadline,title:e.title,targets:e.targets,responsible:e.responsible,chapters:e.chapters},e.title)}));return(0,g.jsx)("div",{className:"calendar-table",children:(0,g.jsxs)("table",{children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{id:"when",children:n("calendarPage.table.when")}),(0,g.jsx)("th",{id:"what",align:"left",children:n("calendarPage.table.what")}),(0,g.jsx)("th",{id:"who",children:n("calendarPage.table.who")}),(0,g.jsx)("th",{id:"target",children:n("calendarPage.table.target")}),(0,g.jsx)("th",{id:"chapters",children:n("calendarPage.table.chapters")})]})}),(0,g.jsx)("tbody",{children:a})]})})};var f=n(9601),p=n(6679),j=n(6859),m=n(6036),w=n(7929);function v(e){return e.chapters.map((e=>e.slug_with_section)).join(",")}function b(e){return e.chapters.map((e=>"https://scout-ch.github.io/hering/"+e.slug_with_section)).join(",")}const P=function(e){var t;const{t:r}=(0,c.Bd)(),[l,i]=(0,a.useState)();if((0,a.useEffect)((()=>{(async()=>{if(!e.tasks||0===e.tasks.length)return void i("");const t=await async function(e,t){const a=n(7785),s=e.map((function(e){const n=e.deadline,a=[];return a.push({action:"display",description:v(e),trigger:{hours:1,before:!0}}),{start:[n.getFullYear(),n.getMonth()+1,n.getDate()],end:[n.getFullYear(),n.getMonth()+1,n.getDate()],title:"".concat(t," ").concat(e.title),description:b(e),url:b(e),status:"CONFIRMED",busyStatus:"FREE",alarms:a}}));return new Promise(((e,t)=>{a.createEvents(s,((n,a)=>{if(n)return void t(n);if(!a)return void t("invalid ics value");const s=new Blob([a],{type:"text/calendar"}),r=window.URL.createObjectURL(s);e(r)}))}))}(e.tasks,e.calendarTitlePrefix);i(t)})()}),[e.tasks,e.calendarTitlePrefix]),!l||0===l.length)return(0,g.jsx)("div",{});const o=(null!==(t=e.calendarTitlePrefix)&&void 0!==t?t:"").length>0?e.calendarTitlePrefix+" ":"";return(0,g.jsxs)("a",{className:"download-btn",id:"ics-download",download:r("calendarPage.ics.filename",{calendarTitlePrefix:o}),href:l,children:[(0,g.jsx)(s.g,{icon:w.l6G}),r("calendarPage.ics.download")]})};function y(e){return e.chapters.map((e=>"https://scout-ch.github.io/hering/"+e.slug_with_section)).join(", ")}const k=function(e){var t;const{t:n}=(0,c.Bd)(),[r,l]=(0,a.useState)();if((0,a.useEffect)((()=>{(()=>{if(!e.tasks||0===e.tasks.length)return void l("");const t=(e=>{let t="".concat(n("calendarPage.table.when"),",").concat(n("calendarPage.table.what"),",").concat(n("calendarPage.table.who"),",").concat(n("calendarPage.table.target"),",").concat(n("calendarPage.table.chapters"),"\n");e.forEach((e=>{const a=e.responsible.map((e=>n("target.role.".concat(e.rolle)))).join(", "),s=e.targets.map((e=>e.rolle)).join(", "),r=[(0,h.GP)(e.deadline,"yyyy-MM-dd"),'"'.concat(e.title,'"'),'"'.concat(a,'"'),'"'.concat(s,'"'),'"'.concat(y(e),'"')].join(",");t+=r+"\n"}));const a=new Blob([t],{type:"text/csv;charset=utf-8;"});return URL.createObjectURL(a)})(e.tasks);l(t)})()}),[e.tasks,e.calendarTitlePrefix,n]),!r||0===r.length)return(0,g.jsx)("div",{});const i=(null!==(t=e.calendarTitlePrefix)&&void 0!==t?t:"").length>0?e.calendarTitlePrefix+" ":"";return(0,g.jsxs)("a",{className:"download-btn",id:"csv-download",download:n("calendarPage.csv.filename",{calendarTitlePrefix:i}),href:r,children:[(0,g.jsx)(s.g,{icon:w.Wxp}),n("calendarPage.csv.download")]})},S="yyyy-MM-dd",N=(0,h.GP)(Date.now(),S),I="all",T="start-date",_="responsible",C="buffer",D="calendar-prefix";const E=function(){const{t:e}=(0,c.Bd)(),[t,n]=(0,a.useState)(N),[s,r]=(0,a.useState)(I),[l,i]=(0,a.useState)(0),[d,h]=(0,a.useState)(""),[u,w]=(0,a.useState)([]),[v,b]=(0,a.useState)([]),y=(0,a.useCallback)((e=>{null===e||void 0===e||e.preventDefault();const n=(0,p.qg)(t,S,Date.now()),a=u.filter((e=>{const t=e.responsible.map((e=>e.rolle));return"all"===s||t.includes(s)})).map((e=>{const t=e.days<0?e.days-l:e.days;return{deadline:-1e3!==e.days?(0,j.o)((0,m.f)(n,t)):new Date(n.getFullYear(),0,1),title:e.title,targets:e.targets,responsible:e.responsible,chapters:e.chapters}})).sort(((e,t)=>e.deadline.getTime()-t.deadline.getTime()));b(a)}),[t,s,l,u]);return(0,a.useEffect)((()=>{y()}),[y]),(0,a.useEffect)((()=>{(()=>{const e=window.sessionStorage.getItem(T);n(e||N);const t=window.sessionStorage.getItem(_);r(t||I);const a=window.sessionStorage.getItem(C);i(parseInt(a||"")||0);const s=window.sessionStorage.getItem(D);h(s||"")})(),(async()=>{const e=await f.A.get("/tasks?_locale="+o.A.language);w(e.data)})()}),[]),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"calendar-form-container",children:(0,g.jsx)("form",{children:(0,g.jsxs)("ul",{className:"calendar-form",children:[(0,g.jsxs)("li",{children:[(0,g.jsx)("label",{htmlFor:"startDate",children:e("calendarPage.startDate")}),(0,g.jsx)("input",{id:"startDate",type:"date",name:"startDate",value:t,onChange:e=>{const t=e.currentTarget.value;n(t),window.sessionStorage.setItem(T,t)}})]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("label",{htmlFor:"responsible",children:e("calendarPage.responsible")}),(0,g.jsxs)("select",{name:"responsible",id:"responsible",value:s,onChange:e=>{const t=e.currentTarget.value;r(t),window.sessionStorage.setItem(_,t)},children:[(0,g.jsx)("option",{value:"all",children:e("calendarPage.responsibleOptions.all")}),(0,g.jsx)("option",{value:"LL",children:e("calendarPage.responsibleOptions.ll")}),(0,g.jsx)("option",{value:"AL",children:e("calendarPage.responsibleOptions.al")}),(0,g.jsx)("option",{value:"C",children:e("calendarPage.responsibleOptions.c")})]})]}),(0,g.jsx)("hr",{}),(0,g.jsxs)("li",{children:[(0,g.jsx)("label",{htmlFor:"puffer",children:e("calendarPage.puffer")}),(0,g.jsx)("input",{type:"number",id:"puffer",name:"puffer",value:l.toString(),onChange:e=>{const t=parseInt(e.currentTarget.value)||0;i(t),window.sessionStorage.setItem(C,t.toString())}})]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("label",{htmlFor:"calendar-prefix",children:e("calendarPage.prefixPlaceholder")}),(0,g.jsxs)("div",{className:"input",children:[(0,g.jsx)("input",{type:"text",name:"calendar-prefix",id:"calendar-prefix",value:d,onChange:e=>{const t=e.currentTarget.value;h(t),window.sessionStorage.setItem(D,t)}}),(0,g.jsx)("div",{className:"calendar-title-prefix-hint",children:e("calendarPage.prefixPreview",{calendarTitlePrefix:d})})]})]})]})})}),(0,g.jsxs)("div",{className:"download-btn-group",children:[(!!window.sessionStorage.getItem(T)||!!window.sessionStorage.getItem(_)||!!window.sessionStorage.getItem(C)||!!window.sessionStorage.getItem(D))&&(0,g.jsx)("button",{className:"download-btn",style:{margin:"0 auto 0 0"},onClick:()=>{window.sessionStorage.removeItem(T),n(N),window.sessionStorage.removeItem(_),r(I),window.sessionStorage.removeItem(C),i(0),window.sessionStorage.removeItem(D),h("")},children:e("calendarPage.resetValues")}),(0,g.jsx)(P,{tasks:v,calendarTitlePrefix:d}),(0,g.jsx)(k,{tasks:v,calendarTitlePrefix:d})]}),(0,g.jsx)(x,{tasks:v,prefix:d})]})};const F=function(e){const t=e.page;return(0,a.useEffect)((()=>{document.title=t.title}),[t]),(0,g.jsx)("div",{className:"content-main",children:(0,g.jsxs)("div",{className:"calendar",children:[(0,g.jsxs)("h1",{children:[(0,g.jsx)(s.g,{icon:w.l6G})," ",t.title]}),(0,g.jsx)(r.o,{remarkPlugins:[l.A],components:i.g,children:t.content}),(0,g.jsx)(E,{})]})})}}}]);
//# sourceMappingURL=176.6dd6a0bc.chunk.js.map